# Hydraulic-servo-excavator-model
The target of this project is to build a hydraulic excavator testing model and to control it by fixed-point path planning. The whole project lasts about three months and we, a group of five students, complete the project together. We come from Shanghai Jiao Tong University Joint Institute and the project is based on the course VM450/VE450.

We listed engineering specifications and find that Young’s modulus is the most significant one while arm length should also be considered more. After confirming the engineering specifications, the whole project is mainly divided into two parts: building of the hydraulic excavator model and controlling the system stably.

To begin with, the concept diagram was made. We chose aluminum and carbon fiber as the materials for our model because of their large strength and rather small density. We deployed ROS to control the model and applied PID control to make it more stable. We selected position control since it is easier to achieve. We use angle sensors to get the feedback data because of the convenience on controlling by values of angles directly. As for PID controller parameters, we used AMESim to find proper values for them.
We have reached all the targets. We did loading test and commanded the excavator to do ten times of automatic digging to confirm its working ability. The hydraulic excavator we built has enough strength to load sand. Also, it is able to dig a straight line with repeated actions and the movements are smooth.


The Arduino will accept the data from the angle sensors and input the data to the computer. The computer then compares them with some reference points and gets the error. The output value can be calculated by the PID controller. The Arduino will give the output value to the servos which control the degrees of the valves and the velocity of the oil is controlled by the degree of the valve. Then the hydraulic rods moved by the pushing of the oil will make the excavator’s arms move. The moving of the arms will change the readings of the angle sensors and refresh all the data.

We design to connect and control all the components of the excavator by the robot operating system. In the robot operating system, all the parts are working as nodes. By publishing or subscribing different topics, we can realize the interaction between different components. Figure 15, shows the working principle for the controlling part. In our system, the cpp program and the Arduino are considered as two nodes. Both of them can be set as publisher or subscriber. A publisher can send message to a topic while a subscriber can get message from a topic. Firstly, the Arduino will get the angle position for each arm, store the data into a structure and then publish the message to topic 2. Secondly, the computer will subscribe topic 2 which makes the computer can get the data. After getting the data, the program will use position control with PID controlling method to deal the data. The main problem of the hydraulic system is that the relationship between the velocity of the oil and the degree of the valve is not linear and we only know that the larger the valve, the faster the velocity. We set the reference angles before the moving. By using the data getting from the angle sensor, we can use the reference angle minors the real angle to get the difference between them which we use “err” to represent it. Our reversing valve has the property that when the degree of valve is smaller than 50degrees, it will make the hydraulic rod extend and the smaller the faster while when the degree of valve is larger than 120degrees, it will make the hydraulic rod extract and the larger the faster. Thus, the degree of the valve can be calculated as 50-P*err or 120+P*err. Finally, the computer will publish these data to topic 1 in the form of the structure and the Arduino will subscribe topic 1 and then input the data to the servo. This process realize that when the arms move towards the designed position, the closer, the slower which makes the arms move smoothly.

The concrete controlling process is listed below: First, Three arms will move to the initial position and the arms will not do next process until all the arms are at the designed initial positions. Second, the bucket will not move while the big arm and the middle arm moves to the designed digging position. Third, After the big arm and the middle arm both move to the designed position, the bucket will do the loading process. Fourth, the big arm and the middle arm will move up and the big servo at the bottom of the base rotates all the upper structures and then the bucket executes the unloading process. Fifth, the wheel turns which makes the excavator move to the next place and repeat the process above.


Electrical System Setup

We have three servos to control the valve. They were connected by the servo extension board. The servo extension board is connected to the Arduino Mega board. We used the battery to give these servos 8V voltage. The angle sensors are supported by the 5V voltage given by the Arduino Mega board and they give their signals to A1, A2 and A3 ports of the Arduino Mega board. The big servo of the base board is controlled by the Arduino Mega 9 port and supported by battery with 12V voltage. The wheels are connected to the Arduino Mega board by the motor extension board and they are given 12V voltage by the battery.
We used the ROS system to control all the parts on the Arduino Mega board.We also use another board to control oil pump, thus the emergency stop will be easier.

The oil pump include the brushless motor, we use the ESC (Electronic Speed Control) to motivate the motor. This works like the servo. We used the 12V battery to give the power.
